<div class="m-0" *ngIf="leaderboard!=null; else elseBlock">
  <div class="mt-3 mb-3 ms-5 me-5">
    <ng-multiselect-dropdown
      [placeholder]="'Select Tests'"
      [settings]="dropdownSettings"
      [data]="leaderboard.testRecords"
      [(ngModel)]="chosenTestRecords"
      (ngModelChange)="setFields()">
    </ng-multiselect-dropdown>
  </div>
  <table *ngIf="!leaderboard.userRecords.empty; else emptyBlock" class="table table-bordered">
    <thead>
    <tr class="table-secondary">
      <th scope="col" style="width: 2.5%">â„–</th>
      <th scope="col" style="width: 10%">Student</th>
      <th scope="col" style="width: 2.5%">Total</th>
      <th
        *ngFor="let iterTestRecord of chosenTestRecords"
        [style.width.%]="85 / chosenTestRecords.length"
        scope="col">
        <a [routerLink]="['/test']" [queryParams]="{id: iterTestRecord.id}">{{iterTestRecord.name}}</a>
      </th>
    </tr>
    </thead>
    <tbody>
    <tr
      *ngFor="let userRecord of leaderboard.userRecords.content; index as i"
      [ngClass]="{'table-info': userRecord.nickname == nickName}">
      <td>{{leaderboard.userRecords.number * pageSize + i + 1}}</td>
      <th scope="row">
        <a class="semi-bold" [class.disabled-link]="!isTeacher"
           [routerLink]="'/user'" [queryParams]="{id: userRecord.id}">
          {{userRecord.nickname}}
        </a>
      </th>
      <td>{{userRecord.total.toFixed(2)}}</td>
      <td *ngFor="let testRecord of chosenTestRecords">
        <span
          [style.color]="userRecord.testToScoreMap.get(testRecord.id.toString()) >= testRecord.passingScore? 'green' : 'red'">
          {{userRecord.testToScoreMap.get(testRecord.id.toString())?.toFixed(2) }}
        </span>
      </td>
    </tr>
    </tbody>
  </table>
  <app-pagination [page]="leaderboard.userRecords" [baseUrl]="'/leaderboard'"></app-pagination>
</div>
<ng-template #emptyBlock>
  <h1 class="text-center m-5 p-5">Nobody is here!</h1>
</ng-template>
<ng-template #elseBlock>
  <app-loading [text]="'Loading...'"></app-loading>
</ng-template>
